from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import RandomForestClassifier
from xgboost import XGBClassifier
from lightgbm import LGBMClassifier

from vecstack import stacking

import numpy as np
import pandas as pd

from sklearn.externals import joblib
import numpy as np
import pandas as pd
from sklearn.metrics import accuracy_score

model_L1_0 = joblib.load('model_L1_0.pkl')
model_L1_1 = joblib.load('model_L1_1.pkl')
model_L1_2 = joblib.load('model_L1_2.pkl')
model_L1_3 = joblib.load('model_L1_3.pkl')
model = joblib.load('model.pkl')

pe_test = pd.read_csv('pe_header.csv')
pe_test = pe_test.drop(['filename', 'MD5','packer_type'], 1)

y_test = pe_test['class']
X_test = pe_test.drop('class',1)

y_pred_L1_0 = model_L1_0.predict(X_test)
y_pred_L1_1 = model_L1_1.predict(X_test)
y_pred_L1_2 = model_L1_2.predict(X_test)
y_pred_L1_3 = model_L1_3.predict(X_test)
S_test_new = np.c_[y_pred_L1_0, y_pred_L1_1,y_pred_L1_2,y_pred_L1_3]

y_pred = model.predict(S_test_new)
